---
layout:     post                    # 使用的布局（不需要改）
title:      Ubuntu           # 标题 
subtitle:   从装机开始 Ubuntu    #副标题
date:       2019-06-05              # 时间
author:     ZYT                     # 作者
header-img: img/linux.jpeg   #这篇文章标题背景图片
catalog: true                       # 是否归档
tags:
    - Liunx                  #标签
---

# 一、背景

心血来潮，想组装一台可以用于 deep learning 的电脑，于是开始了以下的探索之路。

# 二、装机

配件：

- CPU i7-8700
- CPU 散热器
- 技嘉 z370 主板
- 海盗船 16G x 2
- 技嘉 1060 GPU
- 500G SSD
- 3T HDD
- 海盗船 550w 电源
- 机箱

问题：

1. 组装之后电脑屏幕不显示？

主板有检测各个模块是否装机正确的功能，我的在主板的右下角有四个灯，分别显示 CPU、内存、显卡、风扇是否安装正确的提示灯，根据说明书重新安装即可。

# 三、系统

## 1. 安装问题

本来想安装 Ubuntu 19，但是安装之后黑屏，无法打开 grub，被迫装回 18.04，真是坑爹。

有网友说 **安装Linux之前先关闭Security Boot**。

安装过程中，由于使用的是 NVIDIA 的显卡，装机和开机过程中会出现黑屏无法进入系统：**解决方案：进入 GRUB，按 e 进行编辑，找到 `quiet splash`，在之前添加 `nomodeset`， `ctrl + x` 重新进行安装，在第一次开机过程中同样需要设置，进入系统后，打开 terminal，编辑 `/etc/default/grub` 文件，进行同样的修改，更新 `grub`，可执行 `sudo update-grub`。**

更换国内镜像源：

```
sudo vim /etc/apt/sources.list 或者
sudo apt edit-sources

deb http://mirrors.aliyun.com/ubuntu/ trusty main restricted universe multiverse  
deb http://mirrors.aliyun.com/ubuntu/ trusty-security main restricted universe multiverse  
deb http://mirrors.aliyun.com/ubuntu/ trusty-updates main restricted universe multiverse  
deb http://mirrors.aliyun.com/ubuntu/ trusty-proposed main restricted universe multiverse  
deb http://mirrors.aliyun.com/ubuntu/ trusty-backports main restricted universe multiverse  
deb-src http://mirrors.aliyun.com/ubuntu/ trusty main restricted universe multiverse  
deb-src http://mirrors.aliyun.com/ubuntu/ trusty-security main restricted universe multiverse  
deb-src http://mirrors.aliyun.com/ubuntu/ trusty-updates main restricted universe multiverse  
deb-src http://mirrors.aliyun.com/ubuntu/ trusty-proposed main restricted universe multiverse  
deb-src http://mirrors.aliyun.com/ubuntu/ trusty-backports main restricted universe multiverse

sudo apt update
```

## 2. 台式机网卡问题

由于台式机无法用网线连接网络，所以购买了无线网卡，安装发现缺少 `make`、 `gcc` 等一堆东西，折腾之后心态爆炸，突然发现可以**用与手机用 USB 连接共享网络的方式解决这个问题。**

1. 用 USB 与手机连接后，共享网络
2. 由于我是用的是 rtl8812au，可以参考[这篇文章](https://blog.csdn.net/zfcjhdq/article/details/80438148)

## 3. 安装 NVIDIA

设置 root 密码：

```
$ sudo passwd
```

禁用nouveau驱动 (这是需要试验)

```
sudo vim /etc/modprobe.d/blacklist.conf
#添加数据
blacklist vga16fb
blacklist nouveau
blacklist rivafb
blacklist nvidiafb
blacklist rivatv

sudo gedit /etc/modprobe.d/blacklist-nouveau.conf
#添加数据
blacklist nouveau
blacklist lbm-nouveau
options nouveau modeset=0
alias nouveau off
alias lbm-nouveau off

sudo update-initramfs -u
reboot
```

安装 

```
$ sudo apt purge nvidia-*  //删除可能存在的已有驱动
$ sudo add-apt-repository ppa:graphics-drivers/ppa
$ sudo apt update
$ ubuntu-drivers devices
$ sudo ubuntu-drivers autoinstall

$ sudo reboot

$ nvidia-smi   // 测试是否安装正确
$ nvidia-settings 
```
